{% extends 'base.html' %}

{% block content %}
<h1>Enroll in a Course</h1>

<!-- <form method="post">
  <label for="course">Course:</label>
  <select name="course_id" id="course" required>
    {% for course in courses %}
      <option value="{{ course.id }}">{{ course.name }}</option>
    {% endfor %}
  </select>
  <button type="submit" name="action" value="enroll">Enroll</button>
  <button type="submit" name="action" value="drop">Drop</button>
</form> -->

<table class="course-table">
  <thead>
      <tr>
          <th>Course Name</th>
          <th>Capacity</th>
          <th>Enrolled</th>
          <th>Add Class</th>
      </tr>
  </thead>
  <tbody>
      {% for course in courses %}
      <tr>
          <td>{{ course.name }}</td>
          <td>{{ course.capacity }}</td>
          <td>{{ course.enrollments.count() }}</td>
          <td>
              {% if course.id in enrolled_courses %}
                  <!-- Show Drop Button -->
                  <form method="post" style="display:inline;">
                      <input type="hidden" name="course_id" value="{{ course.id }}">
                      <button type="submit" name="action" value="drop">Drop</button>
                  </form>
              {% elif course.enrollments.count() < course.capacity %}
                  <!-- Show Enroll Button -->
                  <form method="post" style="display:inline;">
                      <input type="hidden" name="course_id" value="{{ course.id }}">
                      <button type="submit" name="action" value="enroll">Enroll</button>
                  </form>
              {% else %}
                  <em>Full</em>
              {% endif %}
          </td>
      </tr>
      {% endfor %}
  </tbody>
</table>
{% endblock %}
